<!DOCTYPE HTML>
<!--
    ZeroFour 1.0 by HTML5 Up!
    html5up.net | @n33co
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
        <title>Cloud COPASI - {{ page_title }}</title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,700,800" rel="stylesheet" type="text/css" />
        <script src="{{ STATIC_URL }}js/jquery-1.8.3.min.js"></script>
        <script src="{{ STATIC_URL }}css/5grid/init.js?use=mobile,desktop,1000px&amp;mobileUI=1&amp;mobileUI.theme=none"></script>
        <script src="{{ STATIC_URL }}js/jquery.dropotron-1.2.js"></script>
        <script src="{{ STATIC_URL }}js/init.js"></script>
        <script>
            function formSubmit(formName, display_loading)
            {
                display_loading = typeof display_loading !== 'undefined' ? display_loading : false;
                
                if (display_loading === true) {
                    $('#loading-overlay').fadeIn('slow');
                    $('#loading-box').fadeIn('slow');
                }
                
                document.getElementById(formName).submit();
            }
            function showLoadingScreen()
            {
                    $('#loading-overlay').fadeIn('slow');
                    $('#loading-box').fadeIn('slow');
            }
        function checkResources()
        {
            //Show the checking status message
            $('#checking-text').fadeIn('slow');
            //Get the status as an AJAX call

            $.getJSON("{% url 'api_check_resource' %}", {'user_id': "{{request.user.id}}" }, function(data){
                var bar;
                var status_text;
                if (data.status == 'unrecognized') {
                    bar='warning';
                    status_text = '<a href="{% url "resource_overview" %}">Warning: unrecognized AWS resources in use</a>';
                }
                else if (data.status == 'healthy'){
                    bar = 'healthy';
                    status_text = 'AWS status: healthy';
                }
                else if (data.status == 'problem'){
                    bar = 'error';
                    status_text = 'AWS status: problem';
                }                
                else if (data.status == 'pending'){
                    bar = 'error';
                    status_text = 'Some requested AWS resources may still be pending';
                }
                else if (data.status == 'empty'){
                    bar = 'healthy';
                    status_text = 'No AWS resources in use';
                }
                else if (data.status == 'error'){
                    bar = 'error';
                    status_text = 'Error checking AWS status';
                }
                else {
                    bar = 'error';
                    status_text = 'Unknown status response';
                }
                var bar_name = bar + '-bar'
                var text_name = bar + '-text'
                $('#response-text').html(status_text);
                $('#response-bar').addClass(bar_name)
                $('#response-text').addClass(text_name);
                //Fade out the checking text and fade in the appropriate status bar
                $('#checking-text').fadeOut('slow', function(){
                    $('#response-bar').fadeIn('slow');
                });
            });
        }
        window.onload = checkResources;
        </script>
        <script src="{{ STATIC_URL }}js/popup_box.js"></script>

        <noscript>
            <link rel="stylesheet" href="{{ STATIC_URL }}css/5grid/core.css" />
            <link rel="stylesheet" href="{{ STATIC_URL }}css/5grid/core-desktop.css" />
            <link rel="stylesheet" href="{{ STATIC_URL }}css/5grid/core-1200px.css" />
            <link rel="stylesheet" href="{{ STATIC_URL }}css/5grid/core-noscript.css" />
            <link rel="stylesheet" href="{{ STATIC_URL }}css/style.css" />
            <link rel="stylesheet" href="{{ STATIC_URL }}css/style-desktop.css" />
        </noscript>
        <!--[if lte IE 9]><link rel="stylesheet" href="css/ie9.css" /><![endif]-->
        <!--[if lte IE 8]><link rel="stylesheet" href="css/ie8.css" /><![endif]-->
        <!--[if lte IE 7]><link rel="stylesheet" href="css/ie7.css" /><![endif]-->
    </head>
    <body class="{% block bodyclass %}{% endblock %}" {% if errors %}onload="popup('{% filter escapejs %}{% include 'errorbox.html' %}{% endfilter %}')" {% endif %}>
    <div id="dialog-overlay">
        
    </div>
    <div id="dialog-box">
        <div class="dialog-content">
            <p>
             <div id="dialog-message"> </div>
             </p>
             <p>
                <a href="#" class="button button-popup button-icon button-icon-check">Close</a>
             </p>
        </div>
    </div>
        <!-- Header Wrapper -->
            <div id="header-wrapper">
                <div class="5grid-layout">
                    <div class="row">
                        <div class="12u">
                        
                            <!-- Header -->
                                <header id="header">
                                    <div class="inner">
                                    
                                        <!-- Logo -->
                                            <h1><a href="{% url 'landing_view' %}" class="mobileUI-site-name">Cloud COPASI</a></h1>
                                        
                                        <!-- Nav -->
                                            <nav id="nav" class="mobileUI-site-nav">
                                                <ul>
                                                    <li><a href="{% url 'home' %}">Home</a></li>
                                                    <li>
                                                        <a href="{% url 'about' %}" class="arrow">About</a>
                                                        <ul>
                                                            <li><a href="#">Overview</a></li>
                                                            <li><a href="#">Instruction manual</a></li>
                                                            <li><a href="#">Publications</a></li>
                                                            <li><a href="#">Source code</a></li>
                                                            <li><a href="#">Service status</a></li>

                                                        </ul>
                                                    </li>
                                                    {% if user.is_authenticated %}
                                                    <li><a href="{% url 'my_account' %}">My account</a></li>
                                                    {% if user.is_staff %}
                                                    <li><a href="{% url 'admin:index' %}">Admin</a></li>
                                                    {% endif %}
                                                    <li><a href="{% url 'sign_out' %}">Sign out</a></li>
                                                    {% else %}
                                                    <li><a href="{% url 'sign_in' %}">Sign in</a></li>
                                                    {% endif %}
                                                </ul>
                                            </nav>
                                    
                                    </div>
                                </header>
                                {% block header_content %}
                                {% endblock %}
                        </div>
                    </div>
                </div>
            </div>

        <!--Warning bar -->
        {% if show_status_bar %}
        <div id="status-bar">
            <span id="checking-text">Checking AWS status...</span>
            
            <div id="response-bar">
                        <span id="response-text"> </span>
            </div>
        </div>
        {% endif %}
{% block main_content %}    
{% endblock %}

            
            
{% include 'footer.html' %}


{% include 'loading_screen.html' %}
    </body>
</html>
